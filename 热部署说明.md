# 南昌新东方凭证打印系统 - 热部署说明

## 🔥 热部署功能已启用

现在项目支持热部署，代码修改后会自动重启，无需手动重启服务！

## 📝 使用方法

### 1. 开发环境启动（推荐）
```bash
./start_dev.sh
```
- 自动启用热部署
- 在8080端口运行
- 修改任何Python文件后自动重启

### 2. 生产环境启动
```bash
./start_prod.sh
```
- 关闭热部署（提高性能）
- 在8080端口运行
- 适合生产环境使用

### 3. 手动启动
```bash
# 开发模式
export FLASK_DEBUG=true
export PORT=8080
python3 run.py

# 生产模式
export FLASK_DEBUG=false
export PORT=8080
python3 run.py
```

## ✨ 热部署功能特点

- **自动重启**: 修改`.py`文件后自动重启应用
- **保持端口**: 重启时自动释放和重新绑定端口
- **错误恢复**: 代码错误时自动恢复到上一个可用状态
- **快速开发**: 无需手动重启，提高开发效率

## 🛠️ 支持的文件类型

热部署会监听以下文件的变化：
- `app.py` - 主应用文件
- `run.py` - 启动文件
- `utils/` 目录下的所有Python文件
- `config.py` 等配置文件

## 📌 注意事项

1. **开发环境使用**: 热部署主要用于开发环境，生产环境建议关闭
2. **文件监听**: 只监听Python文件变化，静态文件（CSS/JS）修改不会触发重启
3. **端口占用**: 如果端口被占用，启动脚本会自动清理旧进程

## 🔧 故障排除

### 端口被占用
```bash
# 查看占用8080端口的进程
lsof -i :8080

# 清理所有Python进程
pkill -f "python3.*run.py"
pkill -f "python3.*app.py"
```

### 热部署不工作
```bash
# 确认环境变量设置
echo $FLASK_DEBUG  # 应该是 true

# 手动启动调试模式
FLASK_DEBUG=true python3 run.py
```

## 🎯 开发建议

1. 使用 `./start_dev.sh` 启动开发环境
2. 修改代码保存后，观察终端输出确认自动重启
3. 访问 http://localhost:8080 测试功能
4. 生产部署时使用 `./start_prod.sh`

---

现在你可以愉快地开发了！修改代码后系统会自动重启，大大提高开发效率！ 🚀 